{"version":3,"file":"src_app_views_location-map_location-map_module_ts.js","mappings":"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","sources":["./src/app/views/location-map/location-map-routing.module.ts","./src/app/views/location-map/location-map.module.ts","./src/app/views/location-map/location-map.page.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { LocationMapPage } from './location-map.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: LocationMapPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class LocationMapPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { LocationMapPageRoutingModule } from './location-map-routing.module';\n\nimport { LocationMapPage } from './location-map.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    LocationMapPageRoutingModule\n  ],\n  declarations: [LocationMapPage]\n})\nexport class LocationMapPageModule {}\n","import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { AlertController, LoadingController } from '@ionic/angular';\nimport { Geolocation } from '@awesome-cordova-plugins/geolocation/ngx';\nimport * as Leaflet from 'leaflet';\n\n@Component({\n  selector: 'app-location-map',\n  templateUrl: './location-map.page.html',\n  styleUrls: ['./location-map.page.scss'],\n})\nexport class LocationMapPage implements OnInit, OnDestroy {\n\n  // se instancia el mapa\n  map: Leaflet.Map;\n\n  // marcadores\n  marker: any = [];\n\n  // config icon\n  icon: any = {icon: Leaflet.icon({\n    iconSize: [25,41],\n    iconAnchor: [ 13, 40 ],\n    iconUrl: 'assets/img/map_markers/marker-icon.png',\n    shadowUrl: 'assets/img/map_markers/marker-shadow.png'\n  })}\n\n  // coordenadas\n  coords: any = [];\n\n  // cargando...\n  loading = this.loadingCtrl.create();\n\n  constructor(\n    private geolocation: Geolocation,\n    private loadingCtrl: LoadingController,\n    private alertCtrl: AlertController\n  ) {}\n\n  ngOnInit() {\n    // mostrar mapa\n    this.map = new Leaflet.Map('map');\n    Leaflet.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png', {\n      attribution: 'ovnisolutions.com'\n    }).addTo(this.map);\n\n    this.map.on(\"click\", e => {\n      this.addLocation(e)\n    });\n  }\n\n  ionViewDidEnter() { this.locate(); }\n\n  async locate() {\n    (await this.loading).present();\n    const coordinates = await (await this.geolocation.getCurrentPosition()).coords;\n\n    // dar propiedades de mapa al div mapId, centrar a la zona y dar aumento\n    this.map.setView([coordinates.latitude, coordinates.longitude], 17);\n\n    // cerrar cargando\n    (await this.loading).dismiss();\n\n  }\n\n  async addMyLocation() {\n    const coordinates = await (await this.geolocation.getCurrentPosition()).coords;\n    this.coords = {lat: coordinates.latitude,  long: coordinates.longitude};\n    this.map.removeLayer(this.marker);\n    this.marker = Leaflet.marker([coordinates.latitude, coordinates.longitude], this.icon).addTo(this.map);\n    this.map.setView([coordinates.latitude, coordinates.longitude], 17);\n  }\n\n  async addLocation(data) {\n    this.coords = data.latlng;\n    this.map.removeLayer(this.marker);\n    this.marker = Leaflet.marker([data.latlng.lat, data.latlng.lng], this.icon).addTo(this.map); // add the marker onclick\n  }\n\n  async confirm() {\n    console.log(this.coords)\n    if (this.coords.lat) {\n      this.alertMsg(true)\n    } else {\n      this.alertMsg(false)\n    }\n\n  }\n\n  async alertMsg(type: boolean) {\n\n    const alert = await this.alertCtrl.create({\n      header: 'Debe seleccionar algun sitio para su pedido',\n      buttons: ['Aceptar']\n    });\n\n    const saveAlert = await this.alertCtrl.create({\n      header: '¿Está seguro de seleccionar esta dirección?',\n      buttons: [\n        {\n          text: 'Aceptar',\n          role: 'confirm',\n          handler: async () => {\n            console.log('guardado')\n          }\n        },\n        {\n          text: 'Cancelar',\n          role: 'cancel'\n        }\n      ]\n    });\n\n    if (type) {\n      saveAlert.present();\n    } else {\n      alert.present();\n    }\n  }\n\n  /** Remove map when we have multiple map object */\n  ngOnDestroy() :void {\n    this.map.remove();\n    console.log('mapa cerrado')\n  }\n\n}\n"],"names":["Component","AlertController","LoadingController","Geolocation","Leaflet","LocationMapPage","constructor","geolocation","loadingCtrl","alertCtrl","icon","iconSize","iconAnchor","iconUrl","shadowUrl","create","ngOnInit","map","Map","tileLayer","attribution","addTo","on","e","addLocation","ionViewDidEnter","locate","loading","present","coordinates","getCurrentPosition","coords","setView","latitude","longitude","dismiss","addMyLocation","lat","long","removeLayer","marker","data","latlng","lng","confirm","console","log","alertMsg","type","alert","header","buttons","saveAlert","text","role","handler","ngOnDestroy","remove","selector","template"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}